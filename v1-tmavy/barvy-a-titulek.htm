<!doctype html>
<html lang="cs">
<head profile="http://www.w3.org/2005/10/profile">
<meta charset="UTF-8">

<title>Barvy, titulek a výzva terminálu − Linux: Kniha kouzel</title>

<link rel="stylesheet" type="text/css" href="lkk-20200222.css">
<link rel="alternate stylesheet" type="text/css" href="lkk-20200222-vk-svetly.css" title="Vysoký kontrast: světlá varianta">
<link rel="alternate stylesheet" type="text/css" href="lkk-20200222-vk-tmavy.css" title="Vysoký kontrast: tmavá varianta">
<link rel="alternate stylesheet" type="text/css" href="lkk-20200222-tmavy.css" title="Tmavý motiv">
<link rel="icon" type="image/png" href="obrazky/favicon.png">
</head>
<body id="nahore">
<header>
<span class="left"><a href="index.htm"><img src="obrazky/favicon.png" width="16" height="16" alt=""></a> Linux: Kniha kouzel, vanilková příchuť 1.4 (22. února 2020)</span>
<span class="right"><span class="ico1"></span><span class="ico2"></span><span class="ico3"></span></span>
</header>


<nav class="horni">
<div class="slogan">Veškerá moc příkazové řádky/příkazového řádku přehledně, pro začátečníky i&nbsp;pokročilé</div>
<span class="prev">
<a href="awk.htm" rel="prev" title="2. AWK" accesskey="p">Předchozí&nbsp;kapitola</a>&nbsp;|
</span><a href="index.htm" accesskey="i">Přehled</a><span class="next"><!--
-->&nbsp;| <a href="datum-cas-kalendar.htm" rel="next" title="4. Datum, čas a kalendář" accesskey="n">Následující&nbsp;kapitola</a>
</span>
</nav>


<article>

<h1 class="kapitola">3. <img src="obrazky/ik-vychozi.png" alt="" width="64" height="64"> Barvy, titulek a výzva terminálu</h1>
<div class="stitky"><a href="x-stitky.htm#sbrvy">barvy</a>
<a href="x-stitky.htm#sbsh">bash</a>
<a href="x-stitky.htm#stemtickokruh">tematický okruh</a>
</div><div class="rozcestnikkapitol">
<a href="#cast1" class="sekce">Úvod</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast2" class="sekce">Definice</a><br>
<a href="#cast3" class="sekce">Zaklínadla</a>: <a href="#cast3x1">Titulek</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast3x2">Barvy</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast3x3">Nastavení písma</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast3x4">Zjistit údaje o terminálu</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast3x5">Ovládání kurzoru</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast3x6">Mazání obrazovky</a><br>
<a href="#cast4" class="sekce">Zaklínadla (PS0, PS1 a PS2)</a>: <a href="#cast4x1">Častá</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast4x2">Méně častá</a><br>
<a href="#cast5" class="sekce">Zaklínadla (příklady)</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast6" class="sekce">Parametry příkazů</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast7" class="sekce">Instalace na Ubuntu</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast8" class="sekce">Ukázka</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast9" class="sekce">Tipy a zkušenosti</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast10" class="sekce">Další zdroje informací</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast11" class="sekce">Pomocné funkce</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast12" class="sekce">Snímek obrazovky</a></div>
<h2><a href="#cast1" id="cast1"><span class="cislo">1.</span> Úvod</a></h2>
<p class="ponadpisu">
Tato kapitola pokrývá ovládání barvy písma, barvy pozadí, použitého fontu, titulku terminálového okna a pozice a vlastností kurzoru. Rovněž pokrývá nastavování výzev interpretu bash (PS1 a dalších). Logicky by patřila do kapitoly o příkazovém interpretu bash, ale ta bude velmi rozsáhlá a náročná na zpracování, proto jsem toto téma vydělil/a do samostatné kapitoly.
</p><p>
Barvy a font se v příkazové řádce Linuxu nastavují pomocí takzvaných escape sekvencí, což jsou zvláštní řídicí sekvence bajtů, kterým daný terminál rozumí a místo jejich vypsání na obrazovku změní písmo, přesune kurzor nebo udělá jinou akci, která je v dané sekvenci zakódována. Abychom se tyto sekvence nemuseli učit, používáme místo nich moderní příkaz „tput“, který načte příslušnou sekvenci ze své databáze a vypíše ji na svůj standardní výstup. Pokud tento výstup směřuje přímo na terminál, požadovaná akce se ihned provede; častěji se ale sekvence ukládá do proměnné k pozdějšímu použití; k její aktivaci pak stačí danou proměnnou vypsat na terminál příkazem jako „printf“ či „echo“.
</p><p>
Tato verze kapitoly nepokrývá zvláštní schopnosti konkrétních terminálových programů (např. rozdíly mezi Terminatorem a Konsolí) a podporu šestnácti milionů barev, která zatím v terminálových programech není dostatečně rozšířena (ačkoliv některé už příslušné escape sekvence podporují).
</p><p>
Jedna z prvních věcí, která mě po otevření linuxového terminálu naštvala, bylo to, že neustále barevně zdůrazňoval moje uživatelské jméno a uváděl ho do titulku snad každého terminálového okna. Když si v Xubuntu ve výchozím nastavení poprvé otevřete Terminator a rozdělíte ho na čtyři podokna, svoje uživatelské jméno uvidíte na <i>deseti</i> místech a zopakuje se pokaždé, když máte zadat další příkaz. Mám z toho pocit, že toto nastavení musel navrhovat někdo s narcistickou poruchou osobnosti... Pokud si to chcete předělat, tato kapitola vám poradí jak.
</p>

<h2><a href="#cast2" id="cast2"><span class="cislo">2.</span> Definice</a></h2>
<ul><li><b>Výzva terminálu</b> (zkráceně „výzva“) je řetězec, který interpret příkazového řádku vypisuje před, během nebo po přijetí příkazu od uživatele (tzn. v interaktivním režimu). V interpretu „bash“ se rozeznávají tři druhy výzvy a jejich šablony jsou uloženy v proměnných PS0, PS1 a PS2: <b>hlavní výzva</b> (PS1) značí, že bash očekává příkaz, <b>vedlejší výzva</b> (PS2) značí, že bash očekává pokračování příkazu na dalším řádku, <b>potvrzující výzva</b> (PS0) se vypisuje po přijetí příkazu a před zahájením jeho vykonávání.
</li><li><b>Escape sekvence</b> je posloupnost bajtů, na kterou terminál zareaguje změnou nastavení (např. barvy písma) či nějakou akcí. Escape sekvence začínají netisknutelným znakem „escape“ (ASCII kód 0x1b). V minulosti se zapisovaly ručně a děsily nezkušené uživatele; dnes je však můžeme pohodlně generovat moderním příkazem „tput“, který současně redukuje problémy s kompatibilitou jednotlivých typů terminálů.
</li><li><b>Paleta</b> je v této kapitole pole barev, které daný terminál podporuje, <i>indexované od nuly</i>. Typicky se vyskytují pouze dvě palety: s 8 barvami a s 256 barvami, ačkoliv realizace konkrétních barev v těchto paletách se mohou v jednotlivých terminálech mírně lišit.
</li></ul>
<h2><a href="#cast3" id="cast3"><span class="cislo">3.</span> Zaklínadla</a></h2>

<h3><a href="#cast3x1" id="cast3x1"><span class="cislo">1</span> Titulek</a></h3>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="D">䷊</span>nastavit <b>titulek</b> okna terminálu<sup><a href="#kapbarvyatitulekppc1" id="kapbarvyatitulekppcr1" title="Ve výchozím nastavení nastavuje titulek terminálu jeho hlavní výzva PS1. Proto ji musíte před experimentováním vypnout, např. příkazem „PS=&quot;&quot;“, jinak vám vaše nové nastavení hned přepíše a ani si toho nevšimnete.">(1)</a></sup></div><div class="radky">
<div class="radekzaklinadla">printf %s\\n &quot;$TERM&quot; | egrep -isq &quot;^(xterm|rxvt)&quot; &amp;&amp; printf &quot;\\e]2;%s\\a&quot; &quot;<i class="dopln">nový titulek</i>&quot;</div>
</div></div>

<h3><a href="#cast3x2" id="cast3x2"><span class="cislo">2</span> Barvy</a></h3>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="D">✉</span>vypsat <b>vzorník palety</b> (barvy na pozadí)</div><div class="radky">
<div class="radekzaklinadla">for I in $(seq 0 $(($(tput colors) - 1)))</div>
<div class="radekzaklinadla">do</div>
<div class="radekzaklinadla">printf &quot;%s<span class="viditelnamezera">&nbsp;</span>%3d<span class="viditelnamezera">&nbsp;</span>%s&quot; &quot;$(tput bold;tput setab $I)&quot; $I &quot;$(tput sgr0)&quot;</div>
<div class="radekzaklinadla">test $(($I % 16)) -eq 15 &amp;&amp; printf \\n</div>
<div class="radekzaklinadla">done</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#2 </span><span class="D">ⵅ</span>vypsat vzorník palety (barvy textu)</div><div class="radky">
<div class="radekzaklinadla">for I in $(seq 0 $(($(tput colors) - 1)))</div>
<div class="radekzaklinadla">do</div>
<div class="radekzaklinadla">printf &quot;%s<span class="viditelnamezera">&nbsp;</span>%3d<span class="viditelnamezera">&nbsp;</span>%s&quot; &quot;$(tput bold;tput setaf $I)&quot; $I &quot;$(tput sgr0)&quot;</div>
<div class="radekzaklinadla">test $(($I % 16)) -eq 15 &amp;&amp; printf \\n</div>
<div class="radekzaklinadla">done</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#3 </span><span class="D">➬</span><b>resetovat</b> všechny atributy písma a barev</div><div class="radky">
<div class="radekzaklinadla">tput sgr0</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#4 </span><span class="D">ⴶ</span>nastavit <b>barvu popředí/pozadí</b><sup><a href="#kapbarvyatitulekppc2" id="kapbarvyatitulekppcr2" title="Funkce „bezp_set“ použije ze svých argumentů první podporované číslo barvy. Není-li žádné z uvedených čísel podporováno, žádná barva se nanastaví. Při volání doporučuji jako první uvést číslo pro paletu s 256 barvami a jako druhé číslo náhradní barvy z osmibarevné palety.">(2)</a></sup></div><div class="radky">
<div class="radekzaklinadla">bezp_set setaf <i class="dopln">číslo-barvy</i><span class="tritecky"></span></div>
<div class="radekzaklinadla">bezp_set setab <i class="dopln">číslo-barvy</i><span class="tritecky"></span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#5 </span><span class="D">░</span><b>ztmavit</b> text (jen zapnout)</div><div class="radky">
<div class="radekzaklinadla">tput dim</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#6 </span><span class="D">╰</span>inverzní režim (dočasně prohodí barvy popředí a pozadí; jen zapnout)</div><div class="radky">
<div class="radekzaklinadla">tput rev</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#7 </span><span class="D">⡶</span>neviditelný text (text barvou pozadí; jen zapnout)</div><div class="radky">
<div class="radekzaklinadla">tput invis</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#8 </span><span class="D">╋</span>zvýrazněný mód (zapnout/vypnout)<sup><a href="#kapbarvyatitulekppc3" id="kapbarvyatitulekppcr3" title="Na některých terminálech je realizován jako inverzní text, na jiných jako tučné písmo.">(3)</a></sup></div><div class="radky">
<div class="radekzaklinadla">tput smso</div>
<div class="radekzaklinadla">tput rmso</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#9 </span><span class="D">↨</span>blikající text (jen zapnout; málo podporovaný)<sup><a href="#kapbarvyatitulekppc4" id="kapbarvyatitulekppcr4" title="Používání blikajícího textu se výrazně nedoporučuje, protože je v různých terminálech málo a nejednotně podporován, má mnoho odpůrců a může uživateli způsobovat zdravotní potíže.">(4)</a></sup></div><div class="radky">
<div class="radekzaklinadla">tput blink</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#10 </span><span class="D">⨚</span>vyplnit celý terminál barvou</div><div class="radky">
<div class="radekzaklinadla">bezp_set setab <i class="dopln">číslo-barvy</i> <span class="volznak">[</span><i class="dopln">náhradní-číslo-barvy</i><span class="volznak">]</span><span class="tritecky"></span>; tput clear; tput sgr0</div>
</div></div>

<h3><a href="#cast3x3" id="cast3x3"><span class="cislo">3</span> Nastavení písma</a></h3>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="D">↗</span><b>vypnout všechny atributy</b> písma a barev</div><div class="radky">
<div class="radekzaklinadla">tput sgr0</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#2 </span><span class="D">▨</span><b>tučné</b> písmo (jen zapnout)</div><div class="radky">
<div class="radekzaklinadla">tput bold</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#3 </span><span class="D">◒</span><b>kurzíva</b> (zapnout/vypnout)</div><div class="radky">
<div class="radekzaklinadla">tput sitm</div>
<div class="radekzaklinadla">tput ritm</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#4 </span><span class="D">⊙</span><b>podtržení</b> (zapnout/vypnout)</div><div class="radky">
<div class="radekzaklinadla">tput smul</div>
<div class="radekzaklinadla">tput rmul</div>
</div></div>

<h3><a href="#cast3x4" id="cast3x4"><span class="cislo">4</span> Zjistit údaje o terminálu</a></h3>
<p class="ponadpisu">
Zde uvedené příkazy nevypisují escape sekvence, ale konkrétní hodnoty.
</p>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="D">䷔</span>počet sloupců/řádků terminálu</div><div class="radky">
<div class="radekzaklinadla">tput cols<span class="prikladhodnoty">⊨ 98</span></div>
<div class="radekzaklinadla">tput lines<span class="prikladhodnoty">⊨ 30</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#2 </span><span class="D">⢩</span>počet podporovaných barev (velikost palety)</div><div class="radky">
<div class="radekzaklinadla">tput colors<span class="prikladhodnoty">⊨ 256</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#3 </span><span class="D">≲</span>aktuální sloupec/řádek kurzoru/obojí do proměnných $Y (řádek) a $X (sloupec)</div><div class="radky">
<div class="radekzaklinadla">read -rsd R -p $'\e[6n' &lt;/dev/tty &amp;&amp; printf %s\\n $(($(printf %s\\n &quot;$REPLY&quot; | sed -E 's/.*\[([0-9]+);([0-9]+)/\1/') - 1))</div>
<div class="radekzaklinadla">read -rsd R -p $'\e[6n' &lt;/dev/tty &amp;&amp; printf %s\\n $(($(printf %s\\n &quot;$REPLY&quot; | sed -E 's/.*\[([0-9]+);([0-9]+)/\2/') - 1))</div>
<div class="radekzaklinadla">read -rsd R -p $'\e[6n' &lt;/dev/tty &amp;&amp; eval &quot;$(printf %s\\n &quot;$REPLY&quot; | sed -E 's/.*\[([0-9]+);([0-9]+)/Y=$((\1-1));X=$((\2-1));/')&quot;</div>
</div></div>

<h3><a href="#cast3x5" id="cast3x5"><span class="cislo">5</span> Ovládání kurzoru</a></h3>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="D">⪃</span><b>uložit/obnovit</b> pozici kurzoru</div><div class="radky">
<div class="radekzaklinadla">tput sc</div>
<div class="radekzaklinadla">tput rc</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#2 </span><span class="D">▀</span>posun kurzoru <b>na pozici</b><sup><a href="#kapbarvyatitulekppc5" id="kapbarvyatitulekppcr5" title="Řádky a sloupce jsou číslovány od nuly od levého horního rohu terminálu.">(5)</a></sup></div><div class="radky">
<div class="radekzaklinadla">tput cup <i class="dopln">číslo-řádku</i> <i class="dopln">číslo-sloupce</i></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#3 </span><span class="D">∤</span>posun kurzoru nahoru/dolů/vlevo/vpravo</div><div class="radky">
<div class="radekzaklinadla">tput cuu <i class="dopln">posun</i></div>
<div class="radekzaklinadla">tput cud <i class="dopln">posun</i></div>
<div class="radekzaklinadla">tput cub <i class="dopln">posun</i></div>
<div class="radekzaklinadla">tput cuf <i class="dopln">posun</i></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#4 </span><span class="D">⡙</span>posun kurzoru <b>do určitého sloupce</b> na aktuálním řádku/na začátek řádku</div><div class="radky">
<div class="radekzaklinadla">tput hpa <i class="dopln">index-sloupce</i></div>
<div class="radekzaklinadla">tput hpa 0</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#5 </span><span class="D">⋝</span>posun kurzoru do levého horního rohu/levého dolního rohu</div><div class="radky">
<div class="radekzaklinadla">tput home</div>
<div class="radekzaklinadla">tput cup $(tput lines) 0</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#6 </span><span class="D">⋅</span>skrytí kurzoru/zrušení skrytí</div><div class="radky">
<div class="radekzaklinadla">tput civis</div>
<div class="radekzaklinadla">tput cnorm</div>
</div></div>

<h3><a href="#cast3x6" id="cast3x6"><span class="cislo">6</span> Mazání obrazovky</a></h3>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="D">≜</span>smazat <b>část řádku</b> od kurzoru vlevo/vpravo</div><div class="radky">
<div class="radekzaklinadla">tput el1</div>
<div class="radekzaklinadla">tput el</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#2 </span><span class="D">⊁</span>smazat <b>celou obrazovku</b> a kurzor přesunout na pozici 0 0 (levý horní roh)</div><div class="radky">
<div class="radekzaklinadla">tput clear</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#3 </span><span class="D">⭓</span>odstranit N řádků od aktuálního řádku (včetně) dolů</div><div class="radky">
<div class="radekzaklinadla"><a href="#" class="reseninezname" title="Řešení tohoto příkladu nebylo při vydání této verze kapitoly známo.">?</a></div>
</div></div>

<h2><a href="#cast4" id="cast4"><span class="cislo">4.</span> Zaklínadla (PS0, PS1 a PS2)</a></h2>
<p class="ponadpisu">
Poznámka: escapování zaklínadel v této sekci je upraveno pro uvedení uvnitř dvojitých uvozovek v bashi. Při uvedení jiným způsobem (např. v jednoduchých uvozovkách nebo při načítání ze souboru) je nutno escapování zpětnými lomítky přizpůsobit.
</p>

<h3><a href="#cast4x1" id="cast4x1"><span class="cislo">1</span> Častá</a></h3>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="D">⌄</span><b>znak $</b> pro normálního uživatele a # pro uživatele „root“</div><div class="radky">
<div class="radekzaklinadla">\\\$<span class="prikladhodnoty">⊨ $</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#2 </span><span class="D">⢡</span>provedení příkazu a vypsání jeho výstupu (vyhodnotit hned/vyhodnotit při každém vypsání dané výzvy)<sup><a href="#kapbarvyatitulekppc6" id="kapbarvyatitulekppcr6" title="U druhé varianty (vyhodnotit při každém vypsání výzvy) musíte v příkazu escapovat znaky &quot;, \, $ a !, aby se do příslušné proměnné uložil přesně tak, jak má být vykonán.">(6)</a></sup></div><div class="radky">
<div class="radekzaklinadla">$(<i class="dopln">příkaz</i>)</div>
<div class="radekzaklinadla">\$(<i class="dopln">příkaz</i>)</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#3 </span><span class="D">⌎</span><b>návratový kód</b> posledního příkazu (viz poznámka!)<sup><a href="#kapbarvyatitulekppc7" id="kapbarvyatitulekppcr7" title="Poznámka: Aby tento výraz fungoval, musíte do proměnné PROMPT_COMMAND (ideálně na začátek) přidat příkaz „navr_hodn=$?“, např. příkazem „PROMPT_COMMAND=&quot;navr_hodn=\$?;$PROMPT_COMMAND&quot;“.">(7)</a></sup></div><div class="radky">
<div class="radekzaklinadla">\${navr_hodn}<span class="prikladhodnoty">⊨ 0</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#4 </span><span class="D">⠯</span>cesta/název <b>aktuálního adresáře</b> (v obou případech se domovský adresář nahrazuje znakem „~“)</div><div class="radky">
<div class="radekzaklinadla">\\w<span class="prikladhodnoty">⊨ ~/Dokumenty</span></div>
<div class="radekzaklinadla">\\W<span class="prikladhodnoty">⊨ Dokumenty</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#5 </span><span class="D">☤</span>aktuální <b>čas</b> ve formátu HH:MM/HH:MM:SS</div><div class="radky">
<div class="radekzaklinadla">\\A<span class="prikladhodnoty">⊨ 15:35</span></div>
<div class="radekzaklinadla">\\t<span class="prikladhodnoty">⊨ 15:35:38</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#6 </span><span class="D">❴</span>aktuální <b>datum</b> ve formátu YYYY-MM-DD/ve vlastním formátu<sup><a href="#kapbarvyatitulekppc8" id="kapbarvyatitulekppcr8" title="Pro popis vlastního formátu viz „man strftime“ nebo kapitolu „Datum, čas a kalendář“.">(8)</a></sup></div><div class="radky">
<div class="radekzaklinadla">\\D{%F}<span class="prikladhodnoty">⊨ 2020-01-29</span></div>
<div class="radekzaklinadla">\\D{<i class="dopln">formát</i>}</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#7 </span><span class="D">☲</span><b>název počítače</b> (úplný/jen před první „.“)</div><div class="radky">
<div class="radekzaklinadla">\\H<span class="prikladhodnoty">⊨ mars.podnik</span></div>
<div class="radekzaklinadla">\\h<span class="prikladhodnoty">⊨ mars</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#8 </span><span class="D">⋖</span>konec řádku/tabulátor</div><div class="radky">
<div class="radekzaklinadla">\\n</div>
<div class="radekzaklinadla">$(printf \\t)</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#9 </span><span class="D">╁</span><b>hodnota proměnné</b> při každém vypsání výzvy</div><div class="radky">
<div class="radekzaklinadla">\\\${<i class="dopln">název proměnné</i>}</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#10 </span><span class="D">∆</span><b>uživatelské jméno</b> přihlášeného uživatele/jeho celé jméno</div><div class="radky">
<div class="radekzaklinadla">\\u<span class="prikladhodnoty">⊨ novakova</span></div>
<div class="radekzaklinadla">$(getent passwd $UID | cut -d : -f 5 | cut -d , -f 1)<span class="prikladhodnoty">⊨ Jarmila Nováková</span></div>
</div></div>

<h3><a href="#cast4x2" id="cast4x2"><span class="cislo">2</span> Méně častá</a></h3>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="L">〖</span><b>číslo příkazu</b> (podle historie/pořadové)</div><div class="radky">
<div class="radekzaklinadla">\\!&quot;&quot;<span class="prikladhodnoty">⊨ 1984</span></div>
<div class="radekzaklinadla">\\#<span class="prikladhodnoty">⊨ 9</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#2 </span><span class="D">⪰</span>označení <b>terminálu</b> (alternativy)</div><div class="radky">
<div class="radekzaklinadla">\\l<span class="prikladhodnoty">⊨ 3 (pro textovou konzoli např. „tty3“)</span></div>
<div class="radekzaklinadla">$(ps h -o tty:1 -p $$)<span class="prikladhodnoty">⊨ pts/3 (pro textovou konzoli např. „tty3“)</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#3 </span><span class="D">⡹</span><b>PID</b> příkazového interpretu</div><div class="radky">
<div class="radekzaklinadla">\${\$}<span class="prikladhodnoty">⊨ 3338</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#4 </span><span class="D">☬</span>počet úloh běžících na pozadí (těch, které lze vypsat příkazem „jobs“)</div><div class="radky">
<div class="radekzaklinadla">\\j<span class="prikladhodnoty">⊨ 0</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#5 </span><span class="D">⪞</span>počet řádků/sloupců terminálu</div><div class="radky">
<div class="radekzaklinadla">\${LINES}</div>
<div class="radekzaklinadla">\${COLUMNS}</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#6 </span><span class="D">✻</span>cesta/název aktuálního adresáře (bez zkracování znakem „~“)</div><div class="radky">
<div class="radekzaklinadla">\$(pwd)<span class="prikladhodnoty">⊨ /home/novakova/Dokumenty</span></div>
<div class="radekzaklinadla">\$(basename \$(pwd))<span class="prikladhodnoty">⊨ Dokumenty</span></div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#7 </span><span class="D">䷥</span>znak „$“ pro všechny (i pro uživatele root)</div><div class="radky">
<div class="radekzaklinadla">\$(printf \$)<span class="prikladhodnoty">⊨ $</span></div>
</div></div>

<h2><a href="#cast5" id="cast5"><span class="cislo">5.</span> Zaklínadla (příklady)</a></h2>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="D">Ø</span>návratová hodnota, čas, aktuální adresář a dolar</div><div class="radky">
<div class="radekzaklinadla">function pstput () { printf \\[; tput &quot;$@&quot; &amp;&amp; printf \\]; }</div>
<div class="radekzaklinadla">PROMPT_COMMAND=&quot;navr_hodn=\$?&quot;</div>
<div class="radekzaklinadla">PS1=&quot;$(pstput sgr0)\$navr_hodn $(pstput setaf 6)\A &quot;</div>
<div class="radekzaklinadla">PS1+=&quot;$(pstput sgr0; pstput bold; pstput setaf 2)\w$(pstput sgr0)\\\$<span class="viditelnamezera">&nbsp;</span>&quot;</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#2 </span><span class="D">♜</span>vedlejší výzva: zelené svislítko</div><div class="radky">
<div class="radekzaklinadla">function pstput () { printf \\[; tput &quot;$@&quot; &amp;&amp; printf \\]; }</div>
<div class="radekzaklinadla">PS2=&quot;\\[$(bezp_set setaf 2)\\]|$(pstput sgr0)<span class="viditelnamezera">&nbsp;</span>&quot;</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#3 </span><span class="D">⟹</span>příkazy psát červeně na zeleném pozadí, výpisy příkazů tyrkysově na fialové pozadí</div><div class="radky">
<div class="radekzaklinadla">PS1=&quot;\\[$(bezp_set setaf 1; bezp_set setab 2; tput el)\\]\$<span class="viditelnamezera">&nbsp;</span>&quot;</div>
<div class="radekzaklinadla">PS0=&quot;$(bezp_set setaf 6; bezp_set setab 5; tput el)&quot;</div>
</div></div>

<h2><a href="#cast6" id="cast6"><span class="cislo">6.</span> Parametry příkazů</a></h2>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="D">⨕</span>nastavit šablonu hlavní výzvy/připojit k ní další text (analogicky platí i pro ostatní výzvy)</div><div class="radky">
<div class="radekzaklinadla">PS1=&quot;<i class="dopln">text</i>&quot;</div>
<div class="radekzaklinadla">PS1+=&quot;<i class="dopln">další text</i>&quot;</div>
</div></div>
<p>
<i>Důležitá poznámka:</i> Aby mohl bash správně zformátovat hlavní a vedlejší výzvu (PS1 a PS2), potřebuje předem znát počet tisknutých znaků na každém řádku. Bohužel bash nerozumí escape sekvencím, proto mu musíte napovědět a tyto sekvence uzavřít do zvláštních závorek „\[“ a „\]“ (ve dvojitých uvozovkách se zadávají „\\[“ a „\\]“), které znamenají, že jejich obsah bash nemá při výpočtu šířky řádků vůbec zohledňovat. Tyto závorky se bohužel naopak nesmějí používat v proměnné PS0, tam by vypsaly škaredé paznaky na terminál. V ukázce a v některých zaklínadlech lze tento problém vyřešit tak, že místo přímého zadání příkazu tput použijete pomocnou funkci pstput.
</p>

<h2><a href="#cast7" id="cast7"><span class="cislo">7.</span> Instalace na Ubuntu</a></h2>
<p class="ponadpisu">
Všechny použité součásti jsou základními nástroji přítomnými v každé instalaci Ubuntu.
</p>

<h2><a href="#cast8" id="cast8"><span class="cislo">8.</span> Ukázka</a></h2>
<div class="zaklinadlo"><div class="radky">
<div class="radekzaklinadla">function pstput () {</div>
<div class="radekzaklinadla" style="padding-left:2ch;">printf \\[; tput &quot;$@&quot; &amp;&amp; printf \\]</div>
<div class="radekzaklinadla">}</div>
<div class="radekzaklinadla">PROMPT_COMMAND=&quot;navr_hodn=\$?;$PROMPT_COMMAND&quot;</div>
<div class="radekzaklinadla">PS1=&quot;\\[$(printf %s\\n &quot;$TERM&quot; | egrep -isq &quot;^(xterm|rxvt)&quot; &amp;&amp; printf &quot;\\e]2;%s\\a&quot; &quot;Bude příkaz č. \\#&quot;)\\]&quot;</div>
<div class="radekzaklinadla">PS1+=&quot;Tato $(pstput smul)výzva je $(pstput sitm)zbytečně$(pstput rmul) rozsáhlá, aby ukázala $(pstput bold)spoustu$(pstput sgr0) možností.\\n&quot;</div>
<div class="radekzaklinadla">PS1+=&quot;$(pstput dim)Velikost terminálu: \$(tput cols)x\$(tput lines) Volné místo: $(pstput smul)\$(df -h --output=avail . | tail -n 1 | tr -d \&quot; \&quot;)$(pstput sgr0)\\n&quot;</div>
<div class="radekzaklinadla">PS1+=&quot;Návr.kód:\\[\$(barvapronh \${navr_hodn})\\]\${navr_hodn}$(pstput sgr0)<span class="viditelnamezera">&nbsp;</span>(\\[$(bezp_set setaf 87 6)\\]\\t$(pstput sgr0)) !&quot;&quot;\\!<span class="viditelnamezera">&nbsp;</span>&quot;</div>
<div class="radekzaklinadla">PS1+=&quot;\\[$(bezp_set setaf 220 3; tput bold)\\]\\w$(pstput sgr0)<span class="viditelnamezera">&nbsp;</span>\\$<span class="viditelnamezera">&nbsp;</span>&quot;</div>
<div class="radekzaklinadla">PS2=&quot;\\[$(bezp_set setaf 10 2; tput bold)\\]|<span class="viditelnamezera">&nbsp;</span>$(pstput sgr0)&quot;</div>
</div></div>

<h2><a href="#cast9" id="cast9"><span class="cislo">9.</span> Tipy a zkušenosti</a></h2>
<ul><li>Výchozí nastavení výzev se nachází v souboru „~/.bashrc“. Umístěním svých definic na konec tohoto souboru můžete výchozí nastavení přepsat. Změna se projeví při dalším spuštění bashe.
</li><li>Konstrukci proměnné PS1 je vhodné pro přehlednost rozdělit do více řádků, kdy první řádek bude přiřazení a na dalších použijete operátor += k připojení hodnoty ke stávající hodnotě.
</li><li>Tip: Před zkoušením nastavování barev a titulku terminálu si vypněte výzvu příkazem „PS1=&quot;&quot;“. Výchozí výzva obsahuje escape sekvence, které by kolidovaly s těmi, které se snažíte zadat a rušily by jejich účinek.
</li><li>Bash podporuje proměnnou „PROMPT_COMMAND“. Je-li nastavena, je vykonána jako příkaz těsně před vypsáním hlavní výzvy. Toho lze využít k nastavení proměnných, které pak ve výzvě použijeme. Proměnná PROMPT_COMMAND může obsahovat i více příkazů oddělených středníky. Podle manuálové stránky by příkazy uvedené v této proměnné neměly generovat žádný výstup na terminál! (Ale výstup do souboru je pravděpodobně v pořádku.)
</li></ul>
<h2><a href="#cast10" id="cast10"><span class="cislo">10.</span> Další zdroje informací</a></h2>
<p class="ponadpisu">
Přehled syntaxe pro proměnné PS0, PS1 a PS2 najdete v sekci „PROMPTING“ v manuálové stránce „bash“ (anglicky).
</p><p>
Různé další tipy se dají najít v článku Bash/Prompt customization (anglicky).
</p>
<ul class="kompaktni"><li><a href="https://cs.wikipedia.org/wiki/ANSI_escape_k%C3%B3d">Wikipedie: ANSI escape kód</a>
</li><li><a href="https://wiki.archlinux.org/index.php/Bash/Prompt_customization">Bash/Prompt customization</a> (anglicky)
</li><li><a href="http://www.linuxcommand.org/lc3_adv_tput.php">Command tput</a> (anglicky)
</li><li><a href="https://en.wikipedia.org/wiki/ANSI_escape_code">Wikipedie: ANSI escape code</a> (anglicky)
</li><li><a href="http://www.calmar.ws/vim/256-xterm-24bit-rgb-color-chart.html">xterm-256 Color Chart</a> (anglicky)
</li><li><a href="http://manpages.ubuntu.com/manpages/bionic/en/man1/bash.1.html">Manuálová stránka: bash</a> (anglicky)
</li><li><a href="https://www.youtube.com/watch?v=iaXQdyHRL8M">Video: Customizing Your Terminal | Linux Terminal Beautification</a>
</li><li><a href="https://www.gnu.org/software/termutils/manual/termutils-2.0/html_chapter/tput_1.html">Oficiální příručka příkazu tput</a> (anglicky)
</li><li><a href="https://packages.ubuntu.com/bionic/ncurses-bin">Balíček Bionic: ncurses-bin</a> (anglicky)
</li><li><a href="https://www.youtube.com/watch?v=wOUYzKrGZaA">Video: Customize the Bash Prompt</a> (anglicky)
</li><li><a href="https://www.youtube.com/watch?v=C92eaq_bZR8">Video: Customize &amp; Colorize Your Bash Prompt/Terminal</a> (anglicky)
</li><li><a href="https://www.youtube.com/watch?v=N8pdAvIwj28">Video: Color Variables BASH Shell Script Linux Tutorial</a> (anglicky)
</li></ul>
<h2><a href="#cast11" id="cast11"><span class="cislo">11.</span> Pomocné funkce</a></h2>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#1 </span><span class="D">⪛</span>bezp_set() − nastaví písmo či pozadí na první podporovanou barvu</div><div class="radky">
<div class="radekzaklinadla">function bezp_set () {</div>
<div class="radekzaklinadla" style="padding-left:2ch;">local f=&quot;$1&quot; c=&quot;$(tput colors 2&gt;/dev/null || printf 0)&quot; x=&quot;&quot;</div>
<div class="radekzaklinadla" style="padding-left:2ch;">shift</div>
<div class="radekzaklinadla" style="padding-left:2ch;">for x in $@; do if test $x -lt $c; then tput $f $x; break; fi; done</div>
<div class="radekzaklinadla" style="padding-left:2ch;">return 0</div>
<div class="radekzaklinadla">}</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#2 </span><span class="D">⋂</span>barvapronh() − nastaví barvu písma podle hodnoty parametru</div><div class="radky">
<div class="radekzaklinadla">function barvapronh () {</div>
<div class="radekzaklinadla" style="padding-left:2ch;">test $1 -gt 0 &amp;&amp; tput bold</div>
<div class="radekzaklinadla" style="padding-left:2ch;">test $1 -eq 1 &amp;&amp; bezp_set setaf 1</div>
<div class="radekzaklinadla" style="padding-left:2ch;">test $1 -gt 1 &amp;&amp; bezp_set setaf 2</div>
<div class="radekzaklinadla">}</div>
</div></div>
<div class="zaklinadlo"><hr><div class="zahlavi"><span class="cislo">#3 </span><span class="D">➘</span>pstput() − vypíše escape sekvenci uzavřenou pro použití v proměnných PS1 a PS2</div><div class="radky">
<div class="radekzaklinadla">function pstput () {</div>
<div class="radekzaklinadla" style="padding-left:2ch;">printf \\[; tput &quot;$@&quot; &amp;&amp; printf \\]</div>
<div class="radekzaklinadla">}</div>
</div></div>

<h2><a href="#cast12" id="cast12"><span class="cislo">12.</span> Snímek obrazovky</a></h2>
<figure><img src="obrazky/barvy.png" alt="snímek obrazovky"></figure><div class="ppc"><div id="kapbarvyatitulekppc1"><a href="#kapbarvyatitulekppcr1" class="cislopozn">1</a>&nbsp;Ve výchozím nastavení nastavuje titulek terminálu jeho hlavní výzva PS1. Proto ji musíte před experimentováním vypnout, např. příkazem „PS=&quot;&quot;“, jinak vám vaše nové nastavení hned přepíše a ani si toho nevšimnete.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapbarvyatitulekppc2"><a href="#kapbarvyatitulekppcr2" class="cislopozn">2</a>&nbsp;Funkce „bezp_set“ použije ze svých argumentů první podporované číslo barvy. Není-li žádné z uvedených čísel podporováno, žádná barva se nanastaví. Při volání doporučuji jako první uvést číslo pro paletu s 256 barvami a jako druhé číslo náhradní barvy z osmibarevné palety.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapbarvyatitulekppc3"><a href="#kapbarvyatitulekppcr3" class="cislopozn">3</a>&nbsp;Na některých terminálech je realizován jako inverzní text, na jiných jako tučné písmo.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapbarvyatitulekppc4"><a href="#kapbarvyatitulekppcr4" class="cislopozn">4</a>&nbsp;Používání blikajícího textu se výrazně nedoporučuje, protože je v různých terminálech málo a nejednotně podporován, má mnoho odpůrců a může uživateli způsobovat zdravotní potíže.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapbarvyatitulekppc5"><a href="#kapbarvyatitulekppcr5" class="cislopozn">5</a>&nbsp;Řádky a sloupce jsou číslovány od nuly od levého horního rohu terminálu.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapbarvyatitulekppc6"><a href="#kapbarvyatitulekppcr6" class="cislopozn">6</a>&nbsp;U druhé varianty (vyhodnotit při každém vypsání výzvy) musíte v příkazu escapovat znaky &quot;, \, $ a !, aby se do příslušné proměnné uložil přesně tak, jak má být vykonán.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapbarvyatitulekppc7"><a href="#kapbarvyatitulekppcr7" class="cislopozn">7</a>&nbsp;Poznámka: Aby tento výraz fungoval, musíte do proměnné PROMPT_COMMAND (ideálně na začátek) přidat příkaz „navr_hodn=$?“, např. příkazem „PROMPT_COMMAND=&quot;navr_hodn=\$?;$PROMPT_COMMAND&quot;“.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapbarvyatitulekppc8"><a href="#kapbarvyatitulekppcr8" class="cislopozn">8</a>&nbsp;Pro popis vlastního formátu viz „man strftime“ nebo kapitolu „Datum, čas a kalendář“.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
</div>
<div class="odkazydole"><a href="docker.htm"><img src="obrazky/ik-vychozi.png" alt="" width="32" height="32">Docker</a><a href="zpracovani-videa-a-zvuku.htm"><img src="obrazky/ik-vychozi.png" alt="" width="32" height="32">Zpracování videa a zvuku</a><a href="awk.htm"><img src="obrazky/ik/awk.png" alt="" width="32" height="32">AWK</a></div>

<nav class="spodni"><span class="prev">
<a href="awk.htm" rel="prev" title="2. AWK">Předchozí&nbsp;kapitola</a>&nbsp;|
</span><a href="index.htm">Přehled</a><span class="next"><!--
-->&nbsp;| <a href="datum-cas-kalendar.htm" rel="next" title="4. Datum, čas a kalendář">Následující&nbsp;kapitola</a>
</span>
<a href="#nahore" id="odkaznahoru" title="NAHORU − na začátek stránky">▴<!--⤒--></a>
<a href="#dole" id="odkazdolu" title="DOLŮ − na konec stránky">▾<!--⤓--></a>
</nav>


</article>
<footer id="dole">
<img src="obrazky/by-sa.png" width="88" height="31" alt="[BY-SA]">
<p>Veškerý obsah této stránky (text, obrázky, zdrojový kód) je možno upravovat a šířit pod podmínkami licence
<a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>.
Upozorňuji, že uvedená licence vyžaduje uvedení seznamu autorů, licence a zdroje a poskytnutí stejné
či kompatibilní licence k provedeným změnám, jsou-li nějaké. Příslušné údaje jsou dostupné
na stránce „<a href="x-autori.htm">Přehled autorů</a>“.
Šíření obsahu bez těchto údajů nebo šíření upravené verze bez poskytnutí adekvátní
licence k provedeným úpravám je pravděpodobně porušení licenčních podmínek a může být postihováno.
Poskytování zdrojového kódu při šíření není touto licencí vyžadováno.</p><p>Pro nové verze, další informace, aktuální zdrojový kód
a možnost se zapojit do projektu „Linux: Kniha kouzel“ navštivte jeho
<a href="https://github.com/singularis-mzf/linux-spellbook">repozitář na GitHubu</a>.
</footer>
</body>
</html>
