<!doctype html>
<html lang="cs">
<head profile="http://www.w3.org/2005/10/profile">
<meta charset="UTF-8">

<title>Plánování úloh − Linux: Kniha kouzel</title>

<link rel="stylesheet" type="text/css" href="lkk-20200417.css">
<link rel="alternate stylesheet" type="text/css" href="lkk-20200417-vk-svetly.css" title="Vysoký kontrast: světlá varianta">
<link rel="alternate stylesheet" type="text/css" href="lkk-20200417-vk-tmavy.css" title="Vysoký kontrast: tmavá varianta">
<link rel="alternate stylesheet" type="text/css" href="lkk-20200417-tmavy.css" title="Tmavý motiv">
<link rel="icon" type="image/png" href="obrazky/favicon.png">
</head>
<body id="nahore">
<header>
<span class="left"><a href="index.htm"><img src="obrazky/favicon.png" width="16" height="16" alt=""></a> Linux: Kniha kouzel, vanilková příchuť 1.6 (17. dubna 2020)</span>
<span class="right"><span class="ico1"></span><span class="ico2"></span><span class="ico3"></span></span>
</header>


<nav class="horni">
<div class="slogan">Veškerá moc příkazové řádky/příkazového řádku přehledně, pro začátečníky i&nbsp;pokročilé</div>
<span class="prev">
<a href="markdown.htm" rel="prev" title="10. Markdown" accesskey="p">Předchozí&nbsp;kapitola</a>&nbsp;|
</span><a href="index.htm" accesskey="i">Přehled</a><span class="next"><!--
-->&nbsp;| <a href="prace-s-archivy.htm" rel="next" title="12. Práce s archivy" accesskey="n">Následující&nbsp;kapitola</a>
</span>
</nav>


<article>

<h1 class="kapitola">11. <img src="obrazky/ik-vychozi.png" alt="" width="64" height="64"> Plánování úloh</h1>
<div class="stitky"><a href="x-stitky.htm#scs">čas</a>
<a href="x-stitky.htm#stemtickokruh">tematický okruh</a>
</div><div class="rozcestnikkapitol">
<a href="#cast1" class="sekce">Úvod</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast2" class="sekce">Definice</a><br>
<a href="#cast3" class="sekce">Zaklínadla</a>: <a href="#cast3x1">Pravidelné úlohy (obecně)</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast3x2">Pravidelné úlohy (systémové)</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast3x3">Pravidelné úlohy (plány)</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast3x4">Jednorázové úlohy</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast3x5">Jednorázové úlohy (plány)</a><br>
<a href="#cast4" class="sekce">Parametry příkazů</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast5" class="sekce">Instalace na Ubuntu</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast6" class="sekce">Ukázka</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast7" class="sekce">Tipy a zkušenosti</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast8" class="sekce">Další zdroje informací</a><span class="oddelovac">&nbsp;|</span>
<a href="#cast9" class="sekce">Pomocné funkce a skripty</a></div>
<h2><a href="#cast1" id="cast1"><span class="cislo">1.</span> Úvod</a></h2>
<p class="ponadpisu">
V této kapitole se dozvíte, jak spouštět příkazy automaticky v určený čas.
Linux na tento účel poskytuje dva oddělené mechanismy: prastarý démon „cron“
slouží k pravidelnému (opakovanému) spouštění příkazů, zatímco méně věhlasný
„at“ slouží k naplánování jednorázových úkolů, které budou spuštěny
a zapomenuty. V praxi se ale ke spouštění opakovaných úloh používá i at,
jen je potřeba v rámci každého spuštění úlohy naplánovat její další spuštění.
</p><p>
Mezi cronem a atem je ještě jeden podstatný rozdíl: pokud v době,
kdy má naplánovaná úloha proběhnout, počítač neběží, cron dané spuštění
jednoduše vynechá, zatímco at spustí naplánovanou úlohu,
hned jak to bude možné.
</p><p>
Oběma mechanismům je také společné omezení přesnosti – spuštění lze nastavit
jen s přesností na minuty. Potřebujete-li přesnější zacílení, je třeba,
aby si přesný čas ohlídal až spuštěný proces.
</p><p>
Poznámka: Každý uživatel má vlastní seznam úloh a ty se spouštějí
pod jeho uživatelským účtem. Vedle toho existují i systémové úlohy,
spouštěné pod účtem superuživatele, ty však nejsou touto verzí kapitoly pokryty.
</p>

<h2><a href="#cast2" id="cast2"><span class="cislo">2.</span> Definice</a></h2>
<ul><li><b>Úloha</b> je příkaz naplánovaný k jednorázovému spuštění, jde-li o <b>jednorázovou úlohu</b>, nebo k pravidelnému spouštění, jde-li o <b>pravidelnou úlohu</b>. Tímto příkazem bývá nejčastěji volání uživatelem definovaného skriptu.
</li></ul>
<h2><a href="#cast3" id="cast3"><span class="cislo">3.</span> Zaklínadla</a></h2>

<h3><a href="#cast3x1" id="cast3x1" title="kapitola 11 (Plánování úloh), sekce 3 (Zaklínadla), podsekce 1 (Pravidelné úlohy (obecně))">/s03/p01 Pravidelné úlohy (obecně)</a></h3>
<p class="ponadpisu">
Plán – viz podsekci „Pravidelné úlohy (plány)“.
</p>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1366036311" href="#z1366036311">┲</a><b>přidat</b> nebo <b>nahradit</b> úlohu (spustit na pozadí/spustit v grafickém prostředí)<span class="cislo">#1 </span></div><div class="radky">
<div class="radekzaklinadla">lkk pridat-ulohu <i class="dopln">id-úlohy</i> <i class="dopln">plán</i> '<i class="dopln">příkaz a parametry</i>'</div>
<div class="radekzaklinadla">lkk pridat-ulohu <i class="dopln">id-úlohy</i> <i class="dopln">plán</i> '~/bin/spustit-v-x <i class="dopln">příkaz a parametry</i>'</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1391154480" href="#z1391154480">⠭</a><b>vypsat</b> seznam úloh (id je na konci řádku, za znakem „#“)/vypsat konkrétní úlohu<span class="cislo">#2 </span><sup><a href="#kapplanovaniulohppc1" id="kapplanovaniulohppcr1" title="Poznámka: Znaky „\“ a „%“ jsou ve výpisu odzvláštněny, protože mají pro crontab speciální význam.">(1)</a></sup></div><div class="radky">
<div class="radekzaklinadla">crontab -l</div>
<div class="radekzaklinadla">crontab -l | egrep '#<i class="dopln">id-úlohy</i>$'</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1569245595" href="#z1569245595">✤</a><b>zrušit</b> úlohu/všechny úlohy<span class="cislo">#3 </span></div><div class="radky">
<div class="radekzaklinadla">crontab -l | egrep -v '#<i class="dopln">id-úlohy</i>$' | crontab -</div>
<div class="radekzaklinadla">crontab -r</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1168630790" href="#z1168630790">⋫</a><b>změnit</b> plán úlohy<span class="cislo">#4 </span><sup><a href="#kapplanovaniulohppc2" id="kapplanovaniulohppcr2" title="Vyžaduje nainstalovat balíček „gawk“.">(2)</a></sup></div><div class="radky">
<div class="radekzaklinadla">crontab -l | gawk '{ if (/#<i class="dopln">id-úlohy</i>$/ &amp;&amp; match($0, /^(([^<span class="viditelnamezera">&nbsp;</span>]+<span class="viditelnamezera">&nbsp;</span>){5}|@[a-z]+<span class="viditelnamezera">&nbsp;</span>)/)) {print <i class="dopln">nový-plán</i> substr($0, RLENGTH)} else {print}}' | crontab -</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1912012504" href="#z1912012504">╠</a>uložit tabulku úloh do souboru/načíst ze souboru<span class="cislo">#5 </span></div><div class="radky">
<div class="radekzaklinadla">crontab -l &gt; <i class="dopln">soubor</i></div>
<div class="radekzaklinadla">crontab <i class="dopln">soubor</i></div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1406959387" href="#z1406959387">ᔻ</a>vypsat cizí seznam pravidelných úloh<span class="cislo">#6 </span></div><div class="radky">
<div class="radekzaklinadla">sudo crontab -l -u <i class="dopln">cílový-uživatel</i></div>
</div></div>

<h3><a href="#cast3x2" id="cast3x2" title="kapitola 11 (Plánování úloh), sekce 3 (Zaklínadla), podsekce 2 (Pravidelné úlohy (systémové))">/s03/p02 Pravidelné úlohy (systémové)</a></h3>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1977661180" href="#z1977661180">▃</a>vypsat seznam systémových pravidelných úloh<span class="cislo">#1 </span></div><div class="radky">
<div class="radekzaklinadla"><a href="#" class="reseninezname" title="Řešení tohoto příkladu nebylo při vydání této verze kapitoly známo.">?</a></div>
</div></div>

<h3><a href="#cast3x3" id="cast3x3" title="kapitola 11 (Plánování úloh), sekce 3 (Zaklínadla), podsekce 3 (Pravidelné úlohy (plány))">/s03/p03 Pravidelné úlohy (plány)</a></h3>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1951949521" href="#z1951949521">䷒</a>spouštět každou <b>hodinu</b>/každou hodinu od 10.00 do 15.59<span class="cislo">#1 </span></div><div class="radky">
<div class="radekzaklinadla">&quot;<i class="dopln">číslo-minuty</i> * * * *&quot;</div>
<div class="radekzaklinadla">&quot;<i class="dopln">číslo-minuty</i> 10-15 * * *&quot;</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1383889881" href="#z1383889881">⇶</a>spouštět každou <b>minutu</b><span class="cislo">#2 </span></div><div class="radky">
<div class="radekzaklinadla">&quot;* * * * *&quot;</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z267096487" href="#z267096487">⇬</a>spouštět každých pět minut (alternativy)<span class="cislo">#3 </span></div><div class="radky">
<div class="radekzaklinadla">&quot;*/5 * * * *&quot;</div>
<div class="radekzaklinadla">&quot;0,5,10,15,20,25,30,35,40,45,50,55 * * * *&quot;</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z11344857" href="#z11344857">⠙</a>spouštět hned po startu systému/spouštět po přihlášení<span class="cislo">#4 </span></div><div class="radky">
<div class="radekzaklinadla">&quot;@reboot&quot;</div>
<div class="radekzaklinadla"><a href="#" class="reseninezname" title="Řešení tohoto příkladu nebylo při vydání této verze kapitoly známo.">?</a></div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1250711795" href="#z1250711795">⁝</a>spouštět <b>denně</b>/denně, ale jen od pondělí do pátku<span class="cislo">#5 </span></div><div class="radky">
<div class="radekzaklinadla">&quot;<i class="dopln">číslo-minuty</i> <i class="dopln">číslo-hodiny</i> * * *&quot;</div>
<div class="radekzaklinadla">&quot;<i class="dopln">číslo-minuty</i> <i class="dopln">číslo-hodiny</i> * * 1-5&quot;</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1948954658" href="#z1948954658">✇</a>spouštět <b>týdně</b>, každé pondělí/každou neděli<span class="cislo">#6 </span></div><div class="radky">
<div class="radekzaklinadla">&quot;<i class="dopln">číslo-minuty</i> <i class="dopln">číslo-hodiny</i> * * 1&quot;</div>
<div class="radekzaklinadla">&quot;<i class="dopln">číslo-minuty</i> <i class="dopln">číslo-hodiny</i> * * 7&quot;</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1132048831" href="#z1132048831">⪵</a>spouštět <b>měsíčně</b> v N-tý den měsíce<span class="cislo">#7 </span></div><div class="radky">
<div class="radekzaklinadla">&quot;<i class="dopln">číslo-minuty</i> <i class="dopln">číslo-hodiny</i> <i class="dopln">N</i> * *&quot;</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1595912907" href="#z1595912907">⬟</a>spouštět v druhé a čtvrté pondělí od května do září včetně (celý příkaz)<span class="cislo">#8 </span><sup><a href="#kapplanovaniulohppc3" id="kapplanovaniulohppcr3" title="Rozsahy dnů pro N-tý den týdne v měsíci jsou: první: 1-7, druhý: 8-14, třetí: 15-21, čtvrtý: 22-28, pátý: 29-31.">(3)</a></sup></div><div class="radky">
<div class="radekzaklinadla">lkk pridat-ulohu <i class="dopln">id-úlohy</i> &quot;<i class="dopln">číslo-minuty</i> <i class="dopln">číslo-hodiny</i> 8-14,22-28 5-9 *&quot; 'test $(date +%u) -eq 1 &amp;&amp; <i class="dopln">příkaz</i>'</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1758674828" href="#z1758674828">☛</a>spouštět jednou ročně v určitý den<span class="cislo">#9 </span></div><div class="radky">
<div class="radekzaklinadla">&quot;<i class="dopln">číslo-minuty</i> <i class="dopln">číslo-hodiny</i> <i class="dopln">číslo-dne-v-měsíci</i> <i class="dopln">číslo-měsíce</i> *&quot;</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1050908041" href="#z1050908041">⢲</a>spouštět v poledne 29. února každého přestupného roku<span class="cislo">#10 </span></div><div class="radky">
<div class="radekzaklinadla">&quot;0 12 29 2 *&quot;</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z570546823" href="#z570546823">┗</a>spouštět v poledne každou adventní neděli (celý příkaz)<span class="cislo">#11 </span><sup><a href="#kapplanovaniulohppc4" id="kapplanovaniulohppcr4" title="Uvedený příkaz využívá skutečnost, že adventní neděle se vyskytují pouze v období 27. listopadu až 24. prosince včetně.">(4)</a></sup></div><div class="radky">
<div class="radekzaklinadla">lkk pridat-ulohu <i class="dopln">id-úlohy</i> &quot;0 12 * 11-12 7&quot; 'test 1127 -le $(date +%m%d) -a $(date +%m%d) -le 1224 &amp;&amp; <i class="dopln">příkaz</i>'</div>
</div></div>

<h3><a href="#cast3x4" id="cast3x4" title="kapitola 11 (Plánování úloh), sekce 3 (Zaklínadla), podsekce 4 (Jednorázové úlohy)">/s03/p04 Jednorázové úlohy</a></h3>
<p class="ponadpisu">
Plán – viz sekci „Jednorázové úlohy (plány)“. Plán se zde neuzavírá do uvozovek!
</p>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z331535560" href="#z331535560">❃</a><b>přidat</b> úlohu<span class="cislo">#1 </span></div><div class="radky">
<div class="radekzaklinadla">printf &quot;%s\\n&quot; '<i class="dopln">příkaz</i>'<span class="tritecky"></span> | at <i class="dopln">plán</i></div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z2052030339" href="#z2052030339">☂</a><b>vypsat</b> úlohy (číslo úlohy je v prvním sloupci)<span class="cislo">#2 </span></div><div class="radky">
<div class="radekzaklinadla">atq</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1569245595x" href="#z1569245595x">✤</a><b>zrušit</b> úlohu/všechny úlohy<span class="cislo">#3 </span></div><div class="radky">
<div class="radekzaklinadla">atrm <i class="dopln">číslo-úlohy</i></div>
<div class="radekzaklinadla">atq | cut -f 1 | xargs -r atrm</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1168630790x" href="#z1168630790x">⋫</a><b>změnit</b> plán úlohy<span class="cislo">#4 </span></div><div class="radky">
<div class="radekzaklinadla"><a href="#" class="reseninezname" title="Řešení tohoto příkladu nebylo při vydání této verze kapitoly známo.">?</a></div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z754754859" href="#z754754859">⢪</a>vypsat obsah úlohy<span class="cislo">#5 </span></div><div class="radky">
<div class="radekzaklinadla">at -c <i class="dopln">číslo-úlohy</i></div>
</div></div>

<h3><a href="#cast3x5" id="cast3x5" title="kapitola 11 (Plánování úloh), sekce 3 (Zaklínadla), podsekce 5 (Jednorázové úlohy (plány))">/s03/p05 Jednorázové úlohy (plány)</a></h3>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1307272647" href="#z1307272647">⇰</a>spustit v přesně zadaný čas/31. prosince 2030 ve 2 hodiny a 3 minuty<span class="cislo">#1 </span><sup><a href="#kapplanovaniulohppc5" id="kapplanovaniulohppcr5" title="Hodina, minuta, měsíc a den musí být zadány dvěma číslicemi.">(5)</a></sup></div><div class="radky">
<div class="radekzaklinadla"><i class="dopln">hodina</i>:<i class="dopln">minuta</i> <span class="volznak">[</span><i class="dopln">rok</i>-<i class="dopln">měsíc</i>-<i class="dopln">den</i><span class="volznak">]</span></div>
<div class="radekzaklinadla">02:03 2030-12-31</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1889290238" href="#z1889290238">ⵗ</a>spustit při příštím startu systému/při příštím přihlášení<span class="cislo">#2 </span></div><div class="radky">
<div class="radekzaklinadla"><a href="#" class="reseninezname" title="Řešení tohoto příkladu nebylo při vydání této verze kapitoly známo.">?</a></div>
<div class="radekzaklinadla"><a href="#" class="reseninezname" title="Řešení tohoto příkladu nebylo při vydání této verze kapitoly známo.">?</a></div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z776378456" href="#z776378456">⊑</a>spustit dnes/zítra v 15.30<span class="cislo">#3 </span></div><div class="radky">
<div class="radekzaklinadla">15:30 today</div>
<div class="radekzaklinadla">15:30 tomorrow</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z211436166" href="#z211436166">╃</a>spustit příští úterý ve 12.00<span class="cislo">#4 </span></div><div class="radky">
<div class="radekzaklinadla">12:00 next tuesday</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1871683900" href="#z1871683900">⪉</a>spustit v poledne druhého dne příštího měsíce<span class="cislo">#5 </span></div><div class="radky">
<div class="radekzaklinadla"><a href="#" class="reseninezname" title="Řešení tohoto příkladu nebylo při vydání této verze kapitoly známo.">?</a></div>
</div></div>

<h2><a href="#cast4" id="cast4"><span class="cislo">4.</span> Parametry příkazů</a></h2>
<div class="zaklinadlo"><div class="radky">
<div class="radekzaklinadla">crontab -</div>
<div class="radekzaklinadla">crontab <i class="dopln">soubor</i></div>
<div class="radekzaklinadla">crontab <i class="dopln">parametry</i></div>
</div></div>
<ul class="kompaktni"><li><b>-l</b> :: Vypíše tabulku úloh.
</li><li><b>-u</b> <i class="dopln">uživatel</i> :: Bude pracovat s tabulkou úloh zadaného uživatele (vyžaduje „sudo“).
</li><li><b>-r</b> :: Smaže tabulku úloh.
</li></ul><div class="zaklinadlo"><div class="radky">
<div class="radekzaklinadla">at <i class="dopln">plán</i></div>
<div class="radekzaklinadla">atq</div>
<div class="radekzaklinadla">atrm <i class="dopln">číslo-úlohy</i><span class="tritecky"></span></div>
<div class="radekzaklinadla">at -c <i class="dopln">číslo-úlohy</i><span class="tritecky"></span></div>
</div></div>
<p>
Poznámka: Příkaz „at“ očekává na standardním vstupu skript k provedení.
</p>

<h2><a href="#cast5" id="cast5"><span class="cislo">5.</span> Instalace na Ubuntu</a></h2>
<div class="zaklinadlo"><div class="radky">
<div class="radekzaklinadla">sudo apt-get install at gawk</div>
</div></div>
<p>
Démon „cron“ je základní systémovou součástí Ubuntu a mnoha linuxových
distribucí, proto zpravidla není třeba ho instalovat.
</p>

<h2><a href="#cast6" id="cast6"><span class="cislo">6.</span> Ukázka</a></h2>
<div class="zaklinadlo"><div class="radky">
<div class="radekzaklinadla">mkdir -pv ~/moje_ulohy</div>
<div class="radekzaklinadla">cd ~/moje_ulohy</div>
<div class="radekzaklinadla">printf %s\\n \</div>
<div class="radekzaklinadla" style="padding-left:2ch;">'cd' \</div>
<div class="radekzaklinadla" style="padding-left:2ch;">'sleep 7' \</div>
<div class="radekzaklinadla" style="padding-left:2ch;">'mplayer /usr/share/sounds/sound-icons/piano-3.wav &amp;' \</div>
<div class="radekzaklinadla" style="padding-left:2ch;">'sleep 0.5' \</div>
<div class="radekzaklinadla" style="padding-left:2ch;">'notify-send -i dialog-information &quot;Další minuta uplynula.&quot;' &gt;uloha-minuta</div>
<div class="radekzaklinadla">lkk pridat-ulohu minuta &quot;* * * * *&quot; &quot;~/bin/spustit-v-x bash ~/moje_ulohy/uloha-minuta&quot;</div>
</div></div>
<p>
Poznámka: ukázka vyžaduje nainstalovaný balíček „mplayer“ (a pochopitelně nainstalovaný pomocný skript „~/bin/spustit-v-x“).
</p>

<h2><a href="#cast7" id="cast7"><span class="cislo">7.</span> Tipy a zkušenosti</a></h2>
<ul><li>Pro jakoukoliv netriviální pravidelnou úlohu doporučuji vytvořit samostatný skript a příkazu „lkk pridat-ulohu“ předat volání tohoto skriptu místo vlastních příkazů. Má to celou řadu výhod, např. možnost obsah úlohy editovat, možnost mít víc řádků a použít bash místo /bin/sh. Další výhodou je, že definice se v případě smazání úlohy neztratí a je ji možno použít opakovaně.
</li><li>Naplánované úlohy jsou spouštěny mimo terminál a mimo grafické prostředí, což komplikuje jejich ladění.
</li><li>Ačkoliv mi sekundy u příkazu „at“ nefungují, skript se spouští velmi přesně v nultou sekundu požadované minuty, což vybízí k použití příkazu „sleep“ na začátku spouštěného skriptu k dosažení spuštění v určitou sekundu minuty. Cron tak přesný není.
</li><li>Cron spustí další instanci úlohy i v případě, že předchozí instance ještě běží.
</li><li>Pokud se pravidelná úloha nespustila, zkuste prozkoumat logy, které zobrazíte příkazem:<br>„fgrep CRON /var/log/syslog“. Mohou obsahovat odpovídající chybové hlášení.
</li></ul>
<h2><a href="#cast8" id="cast8"><span class="cislo">8.</span> Další zdroje informací</a></h2>
<div class="zaklinadlo"><div class="radky">
<div class="radekzaklinadla">man 5 crontab</div>
<div class="radekzaklinadla">man 1 crontab</div>
<div class="radekzaklinadla">man at</div>
</div></div>
<ul class="kompaktni"><li><a href="https://cs.wikipedia.org/wiki/Cron">Stránka na Wikipedii: Cron</a>
</li><li><a href="https://cs.wikipedia.org/wiki/At_(Unix)">Stránka na Wikipedii: At</a>
</li><li><a href="https://www.root.cz/clanky/cron-naplanovanie-opakujucich-sa-procesov/">Článek na Root.cz: Cron: naplánovanie opakujúcich sa procesov</a> (slovensky)
</li><li><a href="https://www.linuxexpres.cz/praxe/cron-spravca-uloh">Článek Cron – správca úloh</a> (slovensky)
</li><li><a href="https://www.youtube.com/watch?v=QZJ1drMQz1A">Video „Linux/Mac Tutorial: Cron Jobs“</a> (anglicky)
</li><li><a href="https://www.youtube.com/watch?v=6dJlp133iYg">Video „Crontab Command – 15 Cronjob Scheduling Examples in Linux“</a> (anglicky)
</li><li><a href="http://manpages.ubuntu.com/manpages/bionic/en/man1/at.1posix.html">Manuálová stránka „at“</a> (anglicky)
</li><li><a href="https://packages.ubuntu.com/bionic/at">Bionic: balíček „at“</a> (anglicky)
</li><li><a href="https://packages.ubuntu.com/bionic/bcron-run">Bionic: balíček „bcron-run“</a> (anglicky)
</li><li><a href="https://github.com/tldr-pages/tldr/blob/master/pages/common/crontab.md">TL;DR stránka „crontab“</a> (anglicky)
</li></ul>
<h2><a href="#cast9" id="cast9"><span class="cislo">9.</span> Pomocné funkce a skripty</a></h2>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z1735066045" href="#z1735066045">⇕</a>lkk pridat-ulohu – přidá nebo nahradí pravidelnou úlohu<span class="cislo">#1 </span></div><div class="radky">
<div class="radekzaklinadla">#!/bin/bash -e</div>
<div class="radekzaklinadla">nazevulohy=$1 plan=$2</div>
<div class="radekzaklinadla">shift 2</div>
<div class="radekzaklinadla">(crontab -l 2&gt;/dev/null | sed -E &quot;/#$nazevulohy\$/d&quot;; printf &quot;$plan %s #$nazevulohy\\n&quot; &quot;$@&quot; | sed -E 's/[\\%]/\\&amp;/g') | crontab -</div>
</div></div>
<div class="zaklinadlo"><div class="zahlavi"><a class="ikona D" id="z856242696" href="#z856242696">➻</a>lkk spustit-v-x – slouží ke spouštění grafických aplikací z naplánovaných úloh<span class="cislo">#2 </span><sup><a href="#kapplanovaniulohppc6" id="kapplanovaniulohppcr6" title="Tento skript je vyžadován pro spouštění grafických aplikací z naplánovaných úloh. Pro správný běh takto spuštěných aplikací může být nutno doplnit do seznamu u příkazu „egrep“ mnoho dalších proměnných.">(6)</a></sup></div><div class="radky">
<div class="radekzaklinadla">#!/bin/bash -e</div>
<div class="radekzaklinadla">function f () {</div>
<div class="radekzaklinadla">local xpid=&quot;$(pgrep -u &quot;$(whoami)&quot; '^[A-Za-z0-9]*-session$' | head -n 1)&quot;</div>
<div class="radekzaklinadla">test -n &quot;$xpid&quot; || exit 1</div>
<div class="radekzaklinadla">eval &quot;$(egrep -z '^(DBUS_SESSION_BUS_ADDRESS|DISPLAY|XDG_[A-Z_]+)=' /proc/$xpid/environ | tr \\0 \\n | sed -e s/=/\\n/ -e s/\'/\'\\\\\'\'/g | xargs -rd \\n printf &quot;export %s='%s'\\n&quot;)&quot;</div>
<div class="radekzaklinadla">}</div>
<div class="radekzaklinadla">f</div>
<div class="radekzaklinadla">exec &quot;$@&quot;</div>
</div></div>
<div class="ppc"><div id="kapplanovaniulohppc1"><a href="#kapplanovaniulohppcr1" class="cislopozn">1</a>&nbsp;Poznámka: Znaky „\“ a „%“ jsou ve výpisu odzvláštněny, protože mají pro crontab speciální význam.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapplanovaniulohppc2"><a href="#kapplanovaniulohppcr2" class="cislopozn">2</a>&nbsp;Vyžaduje nainstalovat balíček „gawk“.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapplanovaniulohppc3"><a href="#kapplanovaniulohppcr3" class="cislopozn">3</a>&nbsp;Rozsahy dnů pro N-tý den týdne v měsíci jsou: první: 1-7, druhý: 8-14, třetí: 15-21, čtvrtý: 22-28, pátý: 29-31.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapplanovaniulohppc4"><a href="#kapplanovaniulohppcr4" class="cislopozn">4</a>&nbsp;Uvedený příkaz využívá skutečnost, že adventní neděle se vyskytují pouze v období 27. listopadu až 24. prosince včetně.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapplanovaniulohppc5"><a href="#kapplanovaniulohppcr5" class="cislopozn">5</a>&nbsp;Hodina, minuta, měsíc a den musí být zadány dvěma číslicemi.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
<div id="kapplanovaniulohppc6"><a href="#kapplanovaniulohppcr6" class="cislopozn">6</a>&nbsp;Tento skript je vyžadován pro spouštění grafických aplikací z naplánovaných úloh. Pro správný běh takto spuštěných aplikací může být nutno doplnit do seznamu u příkazu „egrep“ mnoho dalších proměnných.</div>
<script>document.write("<div class=\"zpetdotextu\" onclick=\"window.history.back()\">zpět do textu</div>");</script>
</div>
<div class="odkazydole"><a href="zpracovani-textovych-souboru.htm"><img src="obrazky/ik-vychozi.png" alt="" width="32" height="32">Zpracování textových souborů</a><a href="stahovani-videi.htm"><img src="obrazky/ik-vychozi.png" alt="" width="32" height="32">Stahování videí</a><a href="system.htm"><img src="obrazky/ik-vychozi.png" alt="" width="32" height="32">Systém</a></div>

<nav class="spodni"><span class="prev">
<a href="markdown.htm" rel="prev" title="10. Markdown">Předchozí&nbsp;kapitola</a>&nbsp;|
</span><a href="index.htm">Přehled</a><span class="next"><!--
-->&nbsp;| <a href="prace-s-archivy.htm" rel="next" title="12. Práce s archivy">Následující&nbsp;kapitola</a>
</span>
<a href="#nahore" id="odkaznahoru" title="NAHORU − na začátek stránky">▴<!--⤒--></a>
<a href="#dole" id="odkazdolu" title="DOLŮ − na konec stránky">▾<!--⤓--></a>
</nav>


</article>
<!-- MENU -->
<a href="#menu" id="menu">MENU</a>
<aside>
<div>
<div>Toto je experimentální bezjavascriptové menu ve vývoji.
Zatím prosím použijte k navigaci <a href="index.htm">přehled kapitol</a>.</div>
<a href="awk.htm">AWK</a>
<a href="docker.htm">Docker</a>
<a href="#cast3x2">3x2</a>
<a href="#cast3x1">3x1</a>
<div>Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum<br>
Lorem Ipsum</div></div>
<a href="#zavritmenu" id="zavritmenu">Zavřít&nbsp;menu</a>
</aside>
<!-- *** -->
<footer id="dole">
<img src="obrazky/by-sa.png" width="88" height="31" alt="[BY-SA]">
<p>Veškerý obsah této stránky (text, obrázky, zdrojový kód) je možno upravovat a šířit pod podmínkami licence
<a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>.
Upozorňuji, že uvedená licence vyžaduje uvedení seznamu autorů, licence a zdroje a poskytnutí stejné
či kompatibilní licence k provedeným změnám, jsou-li nějaké. Příslušné údaje jsou dostupné
na stránce „<a href="x-autori.htm">Přehled autorů</a>“.
Šíření obsahu bez těchto údajů nebo šíření upravené verze bez poskytnutí adekvátní
licence k provedeným úpravám je pravděpodobně porušení licenčních podmínek a může být postihováno.
Poskytování zdrojového kódu při šíření není touto licencí vyžadováno.</p><p>Pro nové verze, další informace, aktuální zdrojový kód
a možnost se zapojit do projektu „Linux: Kniha kouzel“ navštivte jeho
<a href="https://github.com/singularis-mzf/linux-spellbook">repozitář na GitHubu</a>.
</footer>
</body>
</html>
